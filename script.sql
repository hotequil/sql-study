DROP TABLE EMPLOYEES CASCADE CONSTRAINTS;

DROP TABLE DEPARTMENTS CASCADE CONSTRAINTS;

DROP SEQUENCE DEPARTMENTS_SEQUENCE;

DROP SEQUENCE EMPLOYEES_SEQUENCE;

CREATE TABLE DEPARTMENTS(
    DEPARTMENT_ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    DEPARTMENT_NAME VARCHAR2(30) NOT NULL
);

CREATE SEQUENCE DEPARTMENTS_SEQUENCE INCREMENT BY 1 START WITH 1;

ALTER TABLE DEPARTMENTS ADD CONSTRAINT PK_DEPARTMENT_ID PRIMARY KEY(DEPARTMENT_ID);

ALTER TABLE DEPARTMENTS ADD CONSTRAINT UN_DEPARTMENT_NAME UNIQUE(DEPARTMENT_NAME);

CREATE TABLE EMPLOYEES(
    REGISTRATION_ID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    EMPLOYEE_NAME VARCHAR2(60) NOT NULL,
    DEPARTMENT_ID NUMBER(2) NOT NULL,
    BIRTH_DATE DATE,
    ADMISSION_DATE DATE NOT NULL,
    SALLARY NUMBER(7, 2) NOT NULL,
    ADDRESS VARCHAR2(80)
);

CREATE SEQUENCE EMPLOYEES_SEQUENCE INCREMENT BY 1 START WITH 1;

ALTER TABLE EMPLOYEES ADD CONSTRAINT PK_REGISTRATION_ID PRIMARY KEY(REGISTRATION_ID);

ALTER TABLE EMPLOYEES ADD CONSTRAINT CK_SALLARY CHECK(SALLARY >= 1000);

ALTER TABLE EMPLOYEES ADD CONSTRAINT FK_DEPARTMENT_ID FOREIGN KEY(DEPARTMENT_ID) REFERENCES DEPARTMENTS(DEPARTMENT_ID);

ALTER TABLE EMPLOYEES ADD EMAIL VARCHAR2(60);

ALTER TABLE EMPLOYEES MODIFY EMAIL VARCHAR(100) NOT NULL;

ALTER TABLE EMPLOYEES DROP COLUMN EMAIL;

-- ALTER TABLE EMPLOYEES DROP CONSTRAINT PK_REGISTRATION_ID;

-- ALTER TABLE EMPLOYEES DROP CONSTRAINT FK_DEPARTMENT_ID CASCADE;

-- ALTER TABLE EMPLOYEES RENAME TO FUNCTIONARY;

ALTER TABLE EMPLOYEES RENAME COLUMN ADMISSION_DATE TO ADMISSION;

SELECT * FROM DEPARTMENTS;

SELECT * FROM EMPLOYEES;

INSERT INTO DEPARTMENTS(DEPARTMENT_ID, DEPARTMENT_NAME) VALUES(DEPARTMENTS_SEQUENCE.nextval, 'New department');

INSERT INTO EMPLOYEES VALUES(EMPLOYEES_SEQUENCE.nextval, 'New employee', DEPARTMENTS_SEQUENCE.currval, SYSDATE, SYSDATE, 2000, 'My address');

UPDATE DEPARTMENTS SET DEPARTMENT_NAME = 'Old department' WHERE DEPARTMENT_ID = 1;

UPDATE EMPLOYEES SET EMPLOYEE_NAME = 'Old employee', SALLARY = 4000 WHERE REGISTRATION_ID = 1;

DELETE FROM EMPLOYEES WHERE REGISTRATION_ID = 1;

DELETE FROM DEPARTMENTS WHERE DEPARTMENT_ID = 1;
